---
title: "Linear regression (lab 3 for BIOS 26122)"
author: "Your Name"
format: 
  html:
    self-contained: true
editor: visual
---

## Description

The goal of this assignment is to use linear regression for both single and multiple variables. You will do the following:

1.  Calculate single variable linear regression and assess its quality

2.  Compare errors for training and test set

3.  Use polynomial regression and assess its quality

4.  Check for overfitting and select appropriate model

```{r setup}
#| include: false
#| echo: false
library(tidyverse)

```

## Heart rates

The following data set contains heart rates measured and reported by students in my class Introduction to Quantitative Modeling for Biology. There are four different heart rates measured (two at rest and two after exercise) and the year it was measured.

```{r}
heart_rates <- read_csv("https://raw.githubusercontent.com/dkon1/intro-ml-bio/main/labs/data/HR_data_combined.csv")
```

1.  Select a response and an explanatory variable (from the 4 heart rate variables) and clean the data to remove any outliers or missing values in these variables. Split the data set into training and test sets of equal size.

    ```{r}


    ```

2.  Use linear regression on the training set and print out the summary. Make a scatterplot and overlay the linear regression model as a line on the same plot. Make a separate plot of the residuals on the training set, and assess whether it looks good (like a shapeless blob). Based on the summary, explain which parameters are significantly different from zero, according to the hypothesis test.

```{r}

```

ANSWERS HERE

3.  Perform quadratic regression on the training set using `lm` and print out the summary. Make a separate plot of the residuals on the training set, and assess whether it looks good (like a shapeless blob). Based on the summary, explain which parameters are significantly different from zero, according to the hypothesis test, and report whether the fit is improved compared to the linear model.

    ```{r}

    ```

    ANSWERS HERE

4.  Use the linear regression model parameters to compute the predicted values for the test set, and calculate the residuals for the test set. Print the variance of the residuals for the training and test sets, and compare them. Use the quadratic regression model to compute the predicted values for the test set using the quadratic regression coefficients, and calculate the residuals for the test set. Print the variance of the residuals for the training and test sets, and compare them. How did adding the quadratic parameter impact the error for the training and test sets?

    ```{r}

    ```

    ANSWERS HERE

5.  Redo the random split of the original data set into training and test sets, leaving progressively smaller fractions of the data in the training set, and calculate linear regression on the training set. Calculate and print the variance of the residuals of the training and test sets, and report whether you observe overfitting.

```{r}
 
```

ANSWERS HERE

### Ecological data

The following data set contains observations of the populations of one species of fish (cutthroat trout) and two species of salamander in Mack Creek, Andrews Forest, Willamette National Forest, Oregon. The data set contains 16 variables and over thirty-two thousand observations. The variables include time and date, location, and measurements, such as size and weight. The metadata (descriptions of data) are provided [here](https://portal.edirepository.org/nis/metadataviewer?packageid=knb-lter-and.4027.14) (click on "Data entities" tab for explanations of each variable.)

```{r}
mack_data <- read_csv("https://raw.githubusercontent.com/dkon1/quant_life_quarto/main/data/mack_data.csv")
```

1.  You will use the numeric variables `length_1_mm` and `weight_g`, examine the data visually to see if there are any missing values or outliers. Clean the data to remove any values you want, and filter the data to contain observations from only one species, either: 'Cutthroat trout' or 'Coastal giant salamander'. Split the remaining data into training and test sets of equal size.

    ```{r}

    ```

2.  Use linear regression on the training set and print out the summary. Make a scatterplot and overlay the linear regression model as a line on the same plot. Make a separate plot of the residuals on the training set, and assess whether it looks good (like a shapeless blob). Based on the summary, explain which parameters are significantly different from zero, according to the hypothesis test.

```{r}

```

ANSWERS HERE

3.  Perform quadratic regression on the training set using `lm` and print out the summary. Make a separate plot of the residuals on the training set, and assess whether it looks good (like a shapeless blob). Based on the summary, explain which parameters are significantly different from zero, according to the hypothesis test, and report whether the fit is improved compared to the linear model.

```{r}

```

ANSWERS HERE

4.  Use the linear regression model parameters to compute the predicted values for the test set, and calculate the residuals for the test set. Print the variance of the residuals for the training and test sets, and compare them. Use the quadratic regression model to compute the predicted values for the test set using the quadratic regression coefficients, and calculate the residuals for the test set. Print the variance of the residuals for the training and test sets, and compare them. How did adding the quadratic parameter impact the error for the training and test sets?

```{r}

```

ANSWERS HERE

5.  Perform a cubic polynomial fit on the same data, print out the summary, and produce the same plots as before. Then compute and print the variance of the residuals for the training and test sets, and compare them. How did adding the cubic parameter impact the error for the training and test sets?

    ```{r}

    ```

ANSWERS HERE
